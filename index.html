<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ERP BETA - Full Version</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="login-screen">
    <div class="login-card">
        <h2>ERP BETA</h2>
        <input type="text" id="u" placeholder="Username">
        <input type="password" id="p" placeholder="Password">
        <button onclick="login()">MASUK</button>
    </div>
</div>

<div id="overlay" onclick="closeAll()"></div>
<div id="toast">Notifikasi</div>

<div id="sidebar">
    <div class="sidebar-header">MENU UTAMA</div>
    <div style="flex-grow: 1; overflow-y: auto;" id="sidebar-content"></div>
    <div style="padding: 15px; border-top: 1px solid var(--border); display: flex; flex-direction: column; gap: 8px;">
        <button class="tab-btn" onclick="openTableManager()" style="background: rgba(26, 115, 232, 0.1); color: var(--primary); border-radius: 12px;">PENGELOLA TABEL</button>
        <button class="tab-btn" onclick="toggleDarkMode()" style="background: rgba(26, 115, 232, 0.1); color: var(--primary); border-radius: 12px;">GANTI TEMA</button>
        <button class="tab-btn" onclick="logout()" style="background: rgba(217, 48, 37, 0.1); color: var(--danger); border-radius: 12px; text-align: center;">LOGOUT</button>
    </div>
</div>

<header>
    <div style="display:flex;align-items:center;gap:12px;">
        <button onclick="toggleSidebar()" style="background:var(--bg-soft);border:1px solid var(--border);padding:8px 12px;border-radius:6px;font-weight:bold;">MENU</button>
        <div id="disp-title" style="font-weight:600;font-size:15px;color:var(--primary);text-transform:uppercase;">Dashboard</div>
    </div>
</header>

<div class="toolbar">
    <div class="date-input-container">
        <input type="text" id="dateRangePicker" placeholder="Tap untuk pilih rentang tanggal..." readonly>
    </div>
    <div style="display:flex; gap:8px; width:100%; align-items:center;">
        <button onclick="exportToExcel()" class="btn-ui" style="font-size:11px;">EXPORT</button>
        <button onclick="document.getElementById('importFile').click()" class="btn-ui" style="font-size:11px;">IMPORT</button>
        <input type="file" id="importFile" hidden onchange="importFromExcel(event)">
        <input type="text" id="searchInp" placeholder="Cari..." oninput="doSearch()" style="flex-grow:1; border:1px solid var(--primary); padding:8px 12px; border-radius:20px; font-size:13px; outline:none;">
    </div>
</div>

<div class="table-container">
    <table id="mainTable">
        <thead><tr id="table-head"></tr></thead>
        <tbody id="table-body"></tbody>
    </table>
</div>

<div class="nav-box">
    <button class="btn-ui" style="padding: 10px 20px;" onclick="changePage(currentPage-1)">KEMBALI</button>
    <div style="display: flex; flex-direction: column; align-items: center; gap: 4px;">
        <div id="page-info" style="font-size:13px; font-weight:800; color:var(--primary);">HALAMAN 1</div>
        <select id="rowsPerPageSelect" onchange="updateRowsPerPage(this.value)" style="border: 1px solid var(--border); border-radius: 4px; font-size: 11px; color: var(--text); background: var(--bg-soft); padding: 2px 8px; cursor: pointer; outline: none;">
            <option value="10">10 Baris</option>
            <option value="25">25 Baris</option>
            <option value="50">50 Baris</option>
            <option value="100">100 Baris</option>
        </select>
    </div>
    <button class="btn-ui" style="padding: 10px 20px;" onclick="changePage(currentPage+1)">LANJUT</button>
</div>

<div id="sheet-menu" class="sheet">
    <div class="sheet-header"><strong>OPSI BARIS</strong><button class="close-btn" onclick="closeModal()">TUTUP</button></div>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
        <button class="btn-ui" style="padding:18px;" onclick="handleExecAction('add_row')">TAMBAH BARIS</button>
        <button class="btn-ui" style="padding:18px;" onclick="handleExecAction('add_col')">TAMBAH KOLOM</button>
        <button class="btn-ui" style="padding:18px; color: var(--danger);" onclick="handleExecAction('del_row')">HAPUS BARIS INI</button>
        <button class="btn-ui" style="padding:18px; color: #fff; background: var(--danger);" onclick="handleExecAction('clear_all')">HAPUS SEMUA</button>
    </div>
</div>

<div id="sheet-filter" class="sheet">
    <div class="sheet-header"><strong>SORTING & KOLOM</strong><button class="close-btn" onclick="closeModal()">TUTUP</button></div>
    <div style="display: flex; flex-direction: column; gap: 8px;">
        <button class="btn-ui" style="padding:16px; text-align:left;" onclick="handleSortData('asc')">URUTKAN A - Z</button>
        <button class="btn-ui" style="padding:16px; text-align:left;" onclick="handleSortData('desc')">URUTKAN Z - A</button>
        <button class="btn-ui" style="padding:16px; text-align:left; color: var(--primary);" onclick="handleExecAction('edit_header')">GANTI NAMA KOLOM</button>
        <button class="btn-ui" style="padding:16px; text-align:left; color: var(--success);" onclick="fillColCurrentDate()">ISI TANGGAL HARI INI</button>
        <button class="btn-ui" style="padding:16px; text-align:left; color: var(--danger);" onclick="handleExecAction('del_col')">HAPUS KOLOM INI</button>
    </div>
</div>

<div id="sheet-table-manager" class="sheet">
    <div class="sheet-header"><strong>PENGELOLA TABEL</strong><button class="close-btn" onclick="closeModal()">TUTUP</button></div>
    <div id="manager-content"></div>
    <div style="display: flex; flex-direction: column; gap: 12px;">
        <button class="btn-ui" style="padding:15px; color:var(--primary);" onclick="createNewTable()">BUAT TABEL BARU</button>
        <button class="btn-ui" style="padding:15px;" onclick="renameTable()">UBAH NAMA TABEL</button>
        <button class="btn-ui" style="padding:15px; background:var(--primary-light);" onclick="openCatPicker()">PINDAH KATEGORI</button>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
            <button class="btn-ui" onclick="moveTable('up')">PINDAH KE ATAS</button>
            <button class="btn-ui" onclick="moveTable('down')">PINDAH KE BAWAH</button>
        </div>
        <button class="btn-ui" style="padding:15px; color:var(--danger);" onclick="deleteCategory()">HAPUS KATEGORI</button>
        <button class="btn-ui" style="padding:15px; color:var(--danger); border: 1px solid var(--danger);" onclick="deleteCurrentTable()">HAPUS TABEL AKTIF</button>
    </div>
</div>

<div id="sheet-cat-picker" class="sheet" style="z-index: 6000;">
    <div class="sheet-header"><strong>PILIH KATEGORI</strong><button class="close-btn" onclick="closeCatPicker()">KEMBALI</button></div>
    <div id="cat-list-box" style="margin-bottom: 20px;"></div>
    <div style="border-top: 1px solid var(--border); padding-top: 15px;">
        <input type="text" id="newCatInp" placeholder="Nama Kategori Baru..." style="width:100%; padding:15px; border-radius:10px; border:1px solid var(--border);">
        <button class="btn-ui" style="width:100%; margin-top:10px; background:var(--primary); color:white; padding:15px;" onclick="applyNewCat()">PINDAH KE KATEGORI INI</button>
    </div>
</div>

<script src="script.js"></script>
</body>
</html>
